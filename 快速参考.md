# CI-SDR 快速参考

## 常用命令速查表

### 环境设置

```bash
# 创建并激活虚拟环境
python -m venv venv
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate   # Windows

# 安装依赖
pip install -r requirements.txt
```

### 数据准备

```bash
# 生成示例数据
python generate_sample_data.py

# 数据格式要求：JSON或CSV，包含 user_id, item_id, rating, review_text
```

### 模型训练

```bash
# 基础训练（使用默认参数）
python train.py --data_path data/sample_reviews.json

# 完整参数训练
python train.py \
    --data_path data/sample_reviews.json \
    --epochs 50 \
    --batch_size 256 \
    --lr 0.002 \
    --alpha_u 0.001 \
    --alpha_i 0.001
```

### 模型评估

```bash
# 基础评估
python evaluate.py --model_path checkpoints/best_model.pth --beta 0.1

# 评估不同beta值
python evaluate.py --model_path checkpoints/best_model.pth --beta 0.05
python evaluate.py --model_path checkpoints/best_model.pth --beta 0.2
```

### 批量beta调优

```bash
# Linux/macOS
for beta in 0.01 0.05 0.1 0.2 0.3; do
    python evaluate.py --model_path checkpoints/best_model.pth --beta $beta
done

# Windows PowerShell
0.01, 0.05, 0.1, 0.2, 0.3 | ForEach-Object {
    python evaluate.py --model_path checkpoints/best_model.pth --beta $_
}
```

## 关键参数说明

| 参数 | 默认值 | 说明 | 建议范围 |
|------|--------|------|---------|
| `--epochs` | 50 | 训练轮数 | 20-100 |
| `--batch_size` | 256 | 批次大小 | 64-512 |
| `--lr` | 0.002 | 学习率 | 0.0005-0.005 |
| `--alpha_u` | 0.001 | 用户情感分支权重 | 0.0001-0.01 |
| `--alpha_i` | 0.001 | 物品情感分支权重 | 0.0001-0.01 |
| `--beta` | 0.1 | 去偏参数 | 0.01-0.5 |

## 评估指标

- **MSE**: 越小越好，整体预测准确度
- **BU**: 越小越好，用户情感偏差（积极 vs 消极用户）
- **BI**: 越小越好，物品情感偏差（热门 vs 冷门物品）

## 文件结构

```
sentiment_basis/
├── data/                    # 数据文件目录
├── checkpoints/             # 模型保存目录
│   └── best_model.pth      # 最佳模型文件
├── config.py               # 配置文件
├── train.py                # 训练脚本
├── evaluate.py             # 评估脚本
└── models/                 # 模型定义
```

## 常见问题快速解决

### 内存不足
```bash
python train.py --data_path data/your_data.json --batch_size 64
```

### 训练太慢
```bash
# 减小数据量或使用GPU
python train.py --data_path data/your_data.json --batch_size 512
```

### 损失不收敛
```bash
python train.py --data_path data/your_data.json --lr 0.0005
```

## 完整工作流示例

```bash
# 1. 准备环境
python -m venv venv && source venv/bin/activate
pip install -r requirements.txt

# 2. 准备数据
python generate_sample_data.py

# 3. 训练模型
python train.py --data_path data/sample_reviews.json --epochs 50

# 4. 评估模型
python evaluate.py --model_path checkpoints/best_model.pth --beta 0.1
```

更多详细信息请参考 `操作文档.md`

